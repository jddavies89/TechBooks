'''
Detect clients of an AP.
Install scapy: sudo pip install scapy

Install aircrack-ng: sudo apt install aircrack-ng

airmon-ng

airmon-ng start wlan0

===Example===

########################
Please enter the AP name: BTHomeHub2-72NQ
New Probe Request:  BTHomeHub2-72NQ
MAC  xx:xx:xx:xx:xx:xx
#######################
'''

#Import all of scapy.
from scapy.all import *

#Declare the interface.
interface = "mon0"

#List of storing probe request.
probe_req = []

#Stores the AP SSID name.
ap_name = raw_input ("Please enter the AP name: ")

def probesniff(fm):
	if fm.haslayer(Dot11ProbeReq): #Filters only probe request.
		client_name = fm.info
		if client_name == ap_name:
			if fm.addr2 not in probe_req:
				print "New Probe Request: ", client_name
				print "MAC ", fm.addr2
				probe_req.append(fm.addr2)
sniff(iface=interface,prn=probesniff)
