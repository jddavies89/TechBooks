'''
Sniffs the SSID, BSSID and Channel number.

Install scapy: sudo pip install scapy

Install aircrack-ng: sudo apt install aircrack-ng

airmon-ng

airmon-ng start wlan0


############
Example.

SSID -->  BTWiFi-with-FON  -- BSSID -->  xx:xx:xx:xx:xx:xx  -- Channel -->  11
SSID -->  BTWiFi  -- BSSID -->  xx:xx:xx:xx:xx:xx  -- Channel -->  11
SSID -->  BTHomeHub2-72NQ  -- BSSID -->  xx:xx:xx:xx:xx:xx  -- Channel -->  11
############
'''

from scapy.all import * #Imports scapy module.
import struct #Imports the struct module.
interface = "mon0" #Interface is the monitor interface.
ap_list = [] #Stores the Addresss.
def info(fm): #Start of function.
	if fm.haslayer(Dot11): #Passes only Dot11 traffic.
		if ((fm.type ==0) & (fm.subtype == 8)): #Passes the frame traffice from 0 to 8, 0 is the managmenet frame and subtype 8 is the beacon frame.
			if fm.addr2 not in ap_list: #Removes any redundancys.
				ap_list.append(fm.addr2) #Adds the address to the list.
				print "SSID --> ", fm.info, " -- BSSID --> ",fm.addr2, " -- Channel --> ", ord(fm[Dot11Elt:3].info) #Prints the SSID, BSSID and Channel on screen.
sniff(iface=interface,prn=info) #sniffs the data with the interface mon0.
