'''
Sometimes firewall and IDS are configured to detect SYN scan, thats why its sometimes better to use FIN scans.

Install scapy: pip install scapy
Fin Scanner
If there is no response, the port is open.
TCP flag: RA means the port is closed and received a RST/ACK.

###################################
----------Ethernet frame----------
destination mac  xxxxxxxxxxxx
Source mac  xxxxxxxxxxxx
----------IP----------
TTL:  64
Source IP 192.168.1.254
Destination IP 192.168.1.70
---------TCP----------
Source port 137
Destination port 1024
Flag: 14
####################################

'''

from scapy.all import * #Import all of scapy.
ip1 = IP(src="192.168.1.70", dst="192.168.1.254")
sy1 = TCP(sport = 1024, dport = 80, flags="F", seq=12345) #"F" declares the FIN flag.
packet = ip1/sy1
p = sr1(packet)
p.show()
